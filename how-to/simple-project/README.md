This is a minimal repository that has features recommended for a small project. These features are described in the PyHC 2024 Summer School ["How-To"](https://docs.google.com/document/d/1PntLwlVvPJiMEZ6hoTtuvqOG2OzufMq5_7nWxr8lbfY/edit#heading=h.22h0gh3t8dul) session.

The size and complexity of this project are at the threshold of where it makes sense to create a package and generalize and refactor the code.

# Overview

This repository contains code for the comparison of field line integration algorithms and the visualization of field lines.

The two primary functions in `main.py` are `compare()` and `generate()`.

The objective of `compare()` is to determine how the location of the equatorial crossing of a dipole field line depends on the integration algorithm. The motivation is that when many field lines must be traced, we want to use the most efficient solver that provides solutions within some error bounds. Here, we only report on the results of the choice of integration algorithm. Other factors influencing the solution are the settings for relative and absolute tolerances.

`compare()` uses SciPy's [`solve_ivp`](https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html) to compute using `RK23` and `RK45` . The difference in the position of the field line at the equatorial crossing is `23 [km]` when the default absolute and relative tolerances are used.

Additional reporting information generated by `compare()` is shown in [`main.log`](main.log).

The function `generate()` creates field lines that can be plotted by executing [`plot.py`](plot.py).

# Install and Run

```
pip install scipy matplotlib
python main.py # creates main.log; see switches at top of file for options
python plot.py # creates figures/field_lines.{pdf,png,svg}
```
